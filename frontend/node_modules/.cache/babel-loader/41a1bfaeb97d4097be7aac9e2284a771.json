{"ast":null,"code":"var _jsxFileName = \"E:\\\\Project\\\\1\\\\Project\\\\ITPM\\\\frontend\\\\src\\\\components\\\\User\\\\updateProfile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport { Form, Input, Button, message, Skeleton, Switch, Upload } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport { updateUser, getUser, updatePassword } from '../../Controllers/Users';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction EditUser(_ref) {\n  _s();\n\n  let {\n    user,\n    userUpdate\n  } = _ref;\n  const dispatch = useDispatch();\n  let {\n    id\n  } = useParams();\n  const [loading, setLoading] = useState(false);\n  const [loadingBtn, setLoadingBtn] = useState(false);\n  const [loadingPass, setLoadingPass] = useState(false);\n  const [hidePass, setHidePass] = useState(false);\n  const [filePath, setFilePath] = useState('');\n\n  const fetchUser = async userId => {\n    const res = await dispatch(getUser(userId));\n    user = res;\n    form.setFieldsValue(res);\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    if (user) {\n      form.setFieldsValue(user);\n    } else {\n      setLoading(true);\n      fetchUser(id);\n    }\n  }, []);\n\n  function onPasswordChange(checked) {\n    setHidePass(checked);\n  }\n\n  const tailFormItemLayout = {\n    wrapperCol: {\n      xs: {\n        span: 24,\n        offset: 0\n      },\n      sm: {\n        span: 16,\n        offset: 8\n      }\n    }\n  };\n  const [form] = Form.useForm();\n  const [passForm] = Form.useForm();\n\n  const onFinish = async values => {\n    setLoadingBtn(true);\n    let updatedUser;\n\n    if (filePath) {\n      updatedUser = {\n        id,\n        ...values,\n        profile_photo: filePath\n      };\n    } else {\n      var _user;\n\n      updatedUser = {\n        id,\n        ...values,\n        profile_photo: (_user = user) === null || _user === void 0 ? void 0 : _user.profile_photo\n      };\n    }\n\n    const res = await dispatch(updateUser(updatedUser));\n\n    if (res.status === 200) {\n      if (user) {\n        userUpdate({ ...updatedUser,\n          regNumber: user.regNumber,\n          role: user.role\n        });\n      }\n\n      message.success(\"Profile Updated Successfully\");\n    } else if (res.status === 401) {\n      message.error(\"Your Password is wrong\");\n    } else {\n      message.error(\"An Error Occurred\");\n    }\n\n    setLoadingBtn(false);\n  };\n\n  const onPasswordUpdate = async values => {\n    setLoadingPass(true);\n    const updatePass = {\n      id,\n      ...values\n    };\n    const res = await dispatch(updatePassword(updatePass));\n\n    if (res.status === 200) {\n      message.success(\"Password Updated Successfully\");\n    } else {\n      message.error(res.data);\n    }\n\n    setLoadingPass(false);\n  };\n\n  const props = {\n    name: 'file',\n    multiple: false,\n    action: 'http://localhost:5000/api/file',\n    maxCount: 1,\n\n    onChange(info) {\n      const {\n        status\n      } = info.file;\n\n      if (status !== 'uploading') {\n        if (info.fileList.length > 0) {\n          setFilePath(info.file.response);\n        } else {\n          setFilePath('');\n        }\n      }\n\n      if (status === 'done') {\n        message.success(`${info.file.name} file uploaded successfully.`);\n      } else if (status === 'error') {\n        message.error(`${info.file.name} file upload failed.`);\n      }\n    }\n\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n        active: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        active: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        active: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        active: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: 'auto',\n            width: '700px',\n            border: '2px solid #9fd1ff',\n            borderRadius: '10px',\n            padding: '30px flex',\n            alignContent: 'space-around'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '400px',\n              margin: 'auto'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              style: {\n                textAlign: 'center',\n                color: '#1890ff'\n              },\n              children: \"Update Profile\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Form, {\n              layout: \"vertical\",\n              form: form,\n              name: \"register\",\n              onFinish: onFinish,\n              scrollToFirstError: true,\n              children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"name\",\n                label: \"Name\",\n                rules: [{\n                  required: true,\n                  message: 'Please input your Name!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"email\",\n                label: \"E-mail\",\n                rules: [{\n                  type: 'email',\n                  message: 'The input is not valid E-mail!'\n                }, {\n                  required: true,\n                  message: 'Please input your E-mail!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"contactNo\",\n                label: \"Phone Number\",\n                rules: [{\n                  required: true,\n                  message: 'Please input your phone number!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(Input, {\n                  style: {\n                    width: '100%'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                children: /*#__PURE__*/_jsxDEV(Upload, { ...props,\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    icon: /*#__PURE__*/_jsxDEV(UploadOutlined, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 182,\n                      columnNumber: 33\n                    }, this),\n                    children: \"Click to Upload Profile Picture\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailFormItemLayout,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"center\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"primary\",\n                    htmlType: \"submit\",\n                    loading: loadingBtn,\n                    style: {\n                      padding: '0 150px'\n                    },\n                    children: \"Update Profile\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 188,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Switch, {\n              onChange: onPasswordChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 15\n            }, this), \" Update Password?\", hidePass ? /*#__PURE__*/_jsxDEV(Form, {\n              layout: \"vertical\",\n              form: passForm,\n              name: \"passForm\",\n              onFinish: onPasswordUpdate,\n              scrollToFirstError: true,\n              children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"oldPassword\",\n                label: \"Old Password\",\n                rules: [{\n                  required: true,\n                  message: 'Please input your password!'\n                }],\n                hasFeedback: true,\n                children: /*#__PURE__*/_jsxDEV(Input.Password, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 215,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"password\",\n                label: \"New Password\",\n                dependencies: ['password'],\n                hasFeedback: true,\n                rules: [{\n                  required: true,\n                  message: 'Please input your new password!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(Input.Password, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailFormItemLayout,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"center\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"primary\",\n                    htmlType: \"submit\",\n                    loading: loadingPass,\n                    style: {\n                      padding: '0 150px'\n                    },\n                    children: \"Update Password\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 17\n            }, this) : '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)\n    }, void 0, false)\n  }, void 0, false);\n}\n\n_s(EditUser, \"72wi4gDfFq9aGBFqV2ikcKWD/Oo=\", false, function () {\n  return [useDispatch, useParams, Form.useForm, Form.useForm];\n});\n\n_c = EditUser;\nexport default EditUser;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditUser\");","map":{"version":3,"sources":["E:/Project/1/Project/ITPM/frontend/src/components/User/updateProfile.js"],"names":["React","useEffect","useState","useParams","useDispatch","Form","Input","Button","message","Skeleton","Switch","Upload","UploadOutlined","updateUser","getUser","updatePassword","EditUser","user","userUpdate","dispatch","id","loading","setLoading","loadingBtn","setLoadingBtn","loadingPass","setLoadingPass","hidePass","setHidePass","filePath","setFilePath","fetchUser","userId","res","form","setFieldsValue","onPasswordChange","checked","tailFormItemLayout","wrapperCol","xs","span","offset","sm","useForm","passForm","onFinish","values","updatedUser","profile_photo","status","regNumber","role","success","error","onPasswordUpdate","updatePass","data","props","name","multiple","action","maxCount","onChange","info","file","fileList","length","response","margin","width","border","borderRadius","padding","alignContent","textAlign","color","required","type"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useDispatch } from 'react-redux';\r\n\r\nimport { Form, Input, Button, message, Skeleton, Switch, Upload } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\n\r\nimport { updateUser, getUser, updatePassword } from '../../Controllers/Users';\r\n\r\nfunction EditUser({user, userUpdate}) {\r\n    const dispatch = useDispatch();\r\n    let { id } = useParams();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingBtn, setLoadingBtn] = useState(false);\r\n    const [loadingPass, setLoadingPass] = useState(false);\r\n    const [ hidePass, setHidePass] = useState(false);\r\n    const [filePath, setFilePath] = useState('');\r\n\r\n    const fetchUser = async(userId) => {\r\n      const res = await dispatch(getUser(userId));\r\n      user = res;\r\n      form.setFieldsValue(res)\r\n      setLoading(false);\r\n  }\r\n    useEffect(() => {\r\n      if(user) {\r\n        form.setFieldsValue(user)\r\n      } else {\r\n        setLoading(true);\r\n        fetchUser(id)\r\n      }\r\n    }, [])\r\n\r\n    function onPasswordChange(checked) {\r\n      setHidePass(checked);\r\n    }\r\n\r\n    const tailFormItemLayout = {\r\n      wrapperCol: {\r\n          xs: {\r\n          span: 24,\r\n          offset: 0,\r\n          },\r\n          sm: {\r\n          span: 16,\r\n          offset: 8,\r\n          },\r\n      },\r\n    };\r\n\r\n  const [form] = Form.useForm();\r\n  const [passForm] = Form.useForm();\r\n\r\n  const onFinish = async(values) => {\r\n    setLoadingBtn(true)\r\n    let updatedUser;\r\n    if (filePath) {\r\n      updatedUser = {id, ...values , profile_photo: filePath};\r\n    } else {\r\n      updatedUser = {id, ...values , profile_photo: user?.profile_photo};\r\n    }\r\n    const res = await dispatch(updateUser(updatedUser))\r\n\r\n    if (res.status === 200) {\r\n      if (user) {\r\n        userUpdate({...updatedUser, regNumber: user.regNumber, role: user.role})\r\n      }\r\n      message.success(\"Profile Updated Successfully\")\r\n    } else if (res.status === 401) {\r\n      message.error(\"Your Password is wrong\")\r\n    }else {\r\n      message.error(\"An Error Occurred\")\r\n    }\r\n    setLoadingBtn(false)\r\n  };\r\n\r\n  const onPasswordUpdate = async(values) => {\r\n    setLoadingPass(true)\r\n    const updatePass = {id, ...values};\r\n    const res = await dispatch(updatePassword(updatePass));\r\n    if (res.status === 200) {\r\n      message.success(\"Password Updated Successfully\")\r\n    } else {\r\n      message.error(res.data)\r\n    }\r\n    setLoadingPass(false)\r\n  }\r\n\r\n  const props = {\r\n    name: 'file',\r\n    multiple: false,\r\n    action: 'http://localhost:5000/api/file',\r\n    maxCount: 1,\r\n    onChange(info) {\r\n      const { status } = info.file;\r\n      if (status !== 'uploading') {\r\n          if (info.fileList.length > 0) {\r\n            setFilePath(info.file.response)\r\n        } else {\r\n            setFilePath('')\r\n        }\r\n      }\r\n      if (status === 'done') {\r\n        message.success(`${info.file.name} file uploaded successfully.`);\r\n      } else if (status === 'error') {\r\n        message.error(`${info.file.name} file upload failed.`);\r\n      }\r\n    },\r\n  };\r\n\r\n    return (\r\n      <>\r\n      {loading ? \r\n        <>\r\n            <Skeleton active /> \r\n            <Skeleton active /> \r\n            <Skeleton active /> \r\n            <Skeleton active /> \r\n        </>\r\n        :\r\n        <>\r\n        <div>\r\n        <br />\r\n        <div style={{margin: 'auto', width:'700px', border: '2px solid #9fd1ff', borderRadius: '10px', padding: '30px flex', alignContent: 'space-around'}}> \r\n        <br />  \r\n          <div style={{width:'400px', margin: 'auto'}}>\r\n            <h2 style={{textAlign: 'center',color: '#1890ff' }}>Update Profile</h2>\r\n            <Form\r\n              layout=\"vertical\"\r\n              form={form}\r\n              name=\"register\"\r\n              onFinish={onFinish}\r\n              scrollToFirstError\r\n            >\r\n              <Form.Item\r\n                name=\"name\"\r\n                label=\"Name\"\r\n                rules={[\r\n                  {\r\n                    required: true,\r\n                    message: 'Please input your Name!',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input />\r\n              </Form.Item>\r\n              <Form.Item\r\n                name=\"email\"\r\n                label=\"E-mail\"\r\n                rules={[\r\n                  {\r\n                    type: 'email',\r\n                    message: 'The input is not valid E-mail!',\r\n                  },\r\n                  {\r\n                    required: true,\r\n                    message: 'Please input your E-mail!',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input />\r\n              </Form.Item>\r\n                <Form.Item\r\n                  name=\"contactNo\"\r\n                  label=\"Phone Number\"\r\n                  rules={[\r\n                    {\r\n                      required: true,\r\n                      message: 'Please input your phone number!',\r\n                    },\r\n                  ]}\r\n                >\r\n                  <Input\r\n                    style={{\r\n                      width: '100%',\r\n                    }}\r\n                  />\r\n                </Form.Item>\r\n                <Form.Item>\r\n                <Upload {...props}>\r\n                  <Button icon={<UploadOutlined />}>Click to Upload Profile Picture</Button>\r\n                </Upload>\r\n                </Form.Item>\r\n\r\n                <Form.Item {...tailFormItemLayout}>\r\n                  <div className=\"center\">\r\n                    <Button type=\"primary\" htmlType=\"submit\" loading={loadingBtn} style={{padding: '0 150px'}}>\r\n                        Update Profile\r\n                    </Button>\r\n                  </div>\r\n                </Form.Item>\r\n              </Form>\r\n\r\n              <Switch onChange={onPasswordChange}/> Update Password?\r\n              { hidePass ? \r\n                <Form\r\n                layout=\"vertical\"\r\n                form={passForm}\r\n                name=\"passForm\"\r\n                onFinish={onPasswordUpdate}\r\n                scrollToFirstError\r\n              >\r\n                <Form.Item\r\n                name=\"oldPassword\"\r\n                label=\"Old Password\"\r\n                rules={[\r\n                  {\r\n                    required: true,\r\n                    message: 'Please input your password!',\r\n                  },\r\n                ]}\r\n                hasFeedback\r\n              >\r\n                <Input.Password />\r\n              </Form.Item>\r\n        \r\n              <Form.Item\r\n                name=\"password\"\r\n                label=\"New Password\"\r\n                dependencies={['password']}\r\n                hasFeedback\r\n                rules={[\r\n                  {\r\n                    required: true,\r\n                    message: 'Please input your new password!',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input.Password />\r\n              </Form.Item>\r\n              <Form.Item {...tailFormItemLayout}>\r\n                <div className=\"center\">\r\n                  <Button type=\"primary\" htmlType=\"submit\" loading={loadingPass} style={{padding: '0 150px'}}>\r\n                      Update Password\r\n                  </Button>\r\n                </div>\r\n              </Form.Item>\r\n                \r\n              </Form> : ''\r\n              }\r\n            </div>\r\n            <br />\r\n            </div> \r\n            </div> \r\n          </>\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default EditUser\r\n"]},"metadata":{},"sourceType":"module"}